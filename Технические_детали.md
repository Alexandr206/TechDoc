# 4. Технические детали

## 4.1 Основные компоненты

Система навигации реализует алгоритм поиска пути A* (A-star), который состоит из следующих ключевых компонентов:

1. **Генерация карты**:
   - Функция `generate_map` отвечает за создание двумерной матрицы, представляющей пространство, по которому будет перемещаться робот. 
   - Эта матрица является основным объектом, описывающим навигационное пространство, где:
     - Ячейки с значением 0 обозначают свободные участки, по которым робот может перемещаться.
     - Ячейки с значением 1 обозначают препятствия, которые недоступны для робота.
   - Возможность задания параметров высоты и ширины карты обеспечивает гибкость в тестировании алгоритма на различных размерах пространства.

2. **Эвристическая функция**:
   - Функция `heuristic` реализует расчет манхэттенского расстояния между двумя точками на карте. 
   - Эвристика используется для оценки расстояния до цели, что позволяет алгоритму A* эффективно направлять поиск к конечной точке.

3. **Поиск пути**:
   - Функция `find_path` реализует алгоритм A* для нахождения кратчайшего пути от начальной точки до целевой, обходя препятствия.
   - Основные этапы работы функции:
     - Инициализация приоритетной очереди (кучи) для обработки узлов, где узлы хранятся в соответствии с их стоимостью.
     - Поддержка словарей, которые фиксируют:
       - Длину пути от начальной точки до каждого узла (g_len).
       - Общую стоимость пути через узел до цели (f_len).
     - Восстановление пути в случае нахождения цели.

4. **Оптимизация пути**:
   - Функция `optimize_path` позволяет улучшить найденный маршрут, исключая ненужные повороты и сокращая путь за счет диагональных перемещений.
   - Это достигается путем анализа последовательности координат и пропуска промежуточных точек, когда они обеспечивают диагональное движение.

## 4.2 Используемые библиотеки

Система навигации основана на следующих библиотеках Python:

1. **NumPy**:
   - Библиотека NumPy предоставляет мощные средства для работы с многомерными массивами и матрицами. 
   - В контексте данной системы, NumPy используется для генерации случайных значений при создании карты и для представления карты как двумерного массива.

2. **Heapq**:
   - Это встроенный модуль Python для работы с приоритетными очередями. Он реализует кучу минимального значения, позволяя эффективно извлекать узлы с наименьшей стоимостью в алгоритме A*.
   - Использование heapq оптимизирует производительность алгоритма.

3. **Matplotlib**:
   - Библиотека Matplotlib используется для визуализации маршрутов и карт. Она позволяет отображать графическое представление карты, а также найденного и оптимизированного пути.
   - Визуализация результатов работы системы важна для анализа и отладки.

## 4.3 Структуры данных

Для реализации системы навигации используются следующие структуры данных:

1. **Двумерный массив (матрица)**:
   - Основной объект, представляющий карту пространства, реализуется в виде двумерного массива NumPy. Каждая ячейка массива имеет значение 0 или 1:
     - 0 — свободная ячейка (робот может перемещаться).
     - 1 — препятствие (робот не может проходить).
   - Размер карты определяется параметрами `height` и `width`, что позволяет адаптировать систему под различные сценарии и условия работы.

2. **Словари**:
   - **g_len**: Словарь, в котором ключами являются координаты узлов, а значениями — длина пути от начальной точки до текущего узла. Использование словарей позволяет быстро получать информацию о длине пути, что улучшает производительность алгоритма.
   - **f_len**: Словарь, где ключами также являются координаты узлов, а значениями — общая стоимость пути от начальной точки до целевой, проходящего через данный узел. Эта структура данных критична для работы алгоритма A*, так как она позволяет принимать решения о приоритетах обработки узлов.
   - **came_from**: Словарь для хранения информации о предыдущих узлах, что позволяет восстанавливать путь после его нахождения. Эффективное использование этой структуры данных способствует быстрому восстановлению маршрута и оптимизации работы алгоритма.

3. **Куча (очередь с приоритетом)**:
   - Реализуется с помощью модуля heapq и используется для хранения узлов, ожидающих обработки. Каждый узел упорядочен по стоимости, что позволяет быстро извлекать узел с наименьшей стоимостью.
   - Куча оптимизирует алгоритм.
